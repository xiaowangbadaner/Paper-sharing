# 第三节 数据质控

完整的6个流程：

1. 原始测序数据的质控
2. read比对，排序和去除重复序列
3. Indel区域重（“重新”的“重”）比对
4. 碱基质量值重校正
5. 变异检测
6. 变异结果质控和过滤

![8ec3a7118bc8e2923ea0f980ba2fd35](pic\8ec3a7118bc8e2923ea0f980ba2fd35.png)

## 认识测序数据——数据质控的意义

NGS测序，以illumina为首基本都是运用**边合成边测序**的技术。碱基的合成依靠的是化学反应，这使得碱基链可以不断地从5'端一直往3'端合成并延伸下去。**但在这个合成的过程中随着合成链的增长，DNA聚合酶的效率会不断下降，特异性也开始变差，这就会带来一个问题——越到后面碱基合成的错误率就会越高**。有时候测序仪在刚开始进行合成反应的时候也会由于反应还不够稳定，同样会带来质量值的波动，不过这个波动一般都在高质量值区域。

![352423605a25376079979f85b15e052](\pic\352423605a25376079979f85b15e052.png)

分析测序数据之前先搞清楚如下两个地方：

- 原始数据是通过哪种测序平台产生的，它们的错误率分布是怎么样的，是否有一定的偏向性和局限性，是否会显著受GC含量的影响等；

- 评估它们有可能影响哪些方面的分析；

一般我们可以从以下几个方面来分析一个原始的测序数据（fastq data）:

- read各个位置的碱基质量值分布

- 碱基的总体质量值分布

- read各个位置上碱基分布比例，目的是为了分析碱基的分离程度

- GC含量分布

- read各位置的N含量

- read是否还包含测序的接头序列

- read重复率，这个是实验的扩增过程所引入的

FastQC，它是一个java程序，能够用于给出测序数据的QC报告，报告中会同时给出上述几个方面的数据图，并提示原来的数据可能还存在着哪些问题。在做read质量值分析的时候，FastQC并不单独查看具体某一条read中碱基的质量值，而是将Fastq文件中所有的read数据都综合起来一起分析。

![640](pic\gihjl5556555fsd.webp)

这个图的横轴是read上碱基的位置，纵轴是碱基质量值。在这个例子中，read的长度是126bp（来自HiSeq X10的测序结果），这应该算是比较长的二代测序序列了。我们可以看到read上的每一个位置都有一个黄色的箱型图表示在该位置上所有碱基的质量分布情况。除了最后一个碱基之外，其他的碱基质量值都基本都在大于30，而且波动很小，说明质量很稳定，这其实是一个非常高质量的结果。而且我们可以看到图中质量值的分布都在绿色背景（代表高质量）的区域。

除了上面read各位置的碱基质量值分布之外，FastQC还会为我们计算其他几个非常有价值的统计结果，包括：

（1）碱基总体质量值分布，只要大部分都高于20，那么就比较正常。

![81eb254e75f34c4b5a8f1120ff099eb](pic\81eb254e75f34c4b5a8f1120ff099eb.png)

Q20和Q30的比例是我们衡量测序质量的一个重要指标。一般来说，对于二代测序，最好是达到Q20的碱基要在95%以上（最差不低于90%），Q30要求大于85%（最差也不要低于80%）。

（2）read各个位置上碱基比例分布

![f958b1ca3c43ca261a2b597f07d0885](pic\f958b1ca3c43ca261a2b597f07d0885.png)

为了分析碱基的分离程度。（AT配对，CG配对，假如测序过程是比较随机的话（随机意味着好），那么在每个位置上A和T比例应该差不多，C和G的比例也应该差不多）

（3）GC含量分布图

![54ee64651b2d24b5f4a2b1898b937e2](\pic\54ee64651b2d24b5f4a2b1898b937e2.png)

GC含量指的是G和C这两中碱基占总碱基的比例。二代测序平台或多或少都存在一定的测序偏向性，我们可以通过查看这个值来协助判断测序过程是否足够随机。

（4）N含量分布图

![640](pic\640.webp)

N在测序数据中一般是不应该出现的，如果出现则意味着，测序的光学信号无法被清晰分辨，如果这种情况多的话，往往意味着测序系统或者测序试剂的错误。

（5）接头序列

![jtxl](pic\jtxl.webp)

测序接头是在测序之前构建测序文库时加上的，其一方面是为了能够结合到flowcell上，另一方面是当有多个样本同时测序的时候能够利用接头信息进行区分。

![6565546546](\pic\6565546546.webp)





















