# Fully Convolutional Networks for Semantic Segmentation

> 之前写的忘记保存，网上抄了一下,来自[CSDN](https://blog.csdn.net/mieleizhi0522/article/details/81914000)

## Abstract

分类网络是把一张图预测成一类，而分割网络是把一张图每个像素都预测一下。也就是**这需要预测一幅图像中所有像素点的类别**。

## The main point

* 不含全连接层(fc)的全卷积(fully conv)网络。可适应任意尺寸输入。 
* 上采样的反卷积(deconv)层。能够输出精细的结果。 
*  结合不同深度层结果的跳级(skip)结构。同时确保鲁棒性和精确性。

## The principle of FCN

分类所使用的网络通常会在最后连接全连接层，它会将原来二维的矩阵(图片)压缩成一维的，从而丢失了空间信息，最后训练输出一个标量，这就是我们的分类标签。

而图像语义分割的输出则需要是个分割图，且不论尺寸大小，但是至少是二维的。所以，我们丢弃全连接层，换上卷积层，而这就是所谓的卷积化了。

![FCN](/pic/FCN.jpg)

按照论文中的网络结构：

![fcn1](/pic/fcn1.jpg)

![fcn2](/pic/fcn2.jpg)

将原来网络的全连接层丢弃，不再是直接将向量拉平，而是使用卷积核去进行卷积，得到heatmap，然后进行反卷积，去还原图像尺寸。

## 反卷积

一种上采样的方法，其实应该叫做转置卷积，它和卷积是一样的，只是反卷积的输出图像大于输入图像。

## 跳跃结构(Skip Architecture)

直接将全卷积后的结果上采样后得到的结果通常是很粗糙的。所以这一结构主要是用来优化最终结果的，思路就是将不同池化层的结果进行上采样，然后结合这些结果来优化输出，如上面插图所示一样，将原来第n层卷积得到的结果整合到后面的反卷积层处。

![fcn3](/pic/fcn3.jpg)

结果如下图所示

![fcn4](/pic/fcn4.jpg)

---------------------------

# 本文有几个评价指标：

通常都是像素精度以及IoU的变种。

![图像分割公式](/pic/图像分割公式.jpg)

* Pixel Accuracy(PA，像素精度)：这是最简单的度量，为标记正确的像素占总像素的比例。
* Mean Pixel Accuracy(MPA，均像素精度)：是PA的一种简单提升，计算每个类内被正确分类像素数的比例，之后求所有类的平均。
* Mean Intersection over Union(MIoU，均交并比)：为语义分割的标准度量。其计算两个集合的交集和并集之比，在语义分割的问题中，这两个集合为真实值（ground truth）和预测值（predicted segmentation）。这个比例可以变形为正真数（intersection）比上真正、假负、假正（并集）之和。在每个类上计算IoU，之后平均。
* 在以上所有的度量标准中，**MIoU**由于其简洁、代表性强而成为最常用的度量标准，大多数研究人员都使用该标准报告其结果。

------------------------

# 补充

优缺点：

FCN对图像进行了像素级的分类，从而解决了语义级别的图像分割问题；
FCN可以接受任意尺寸的输入图像，可以保留下原始输入图像中的空间信息；
得到的结果由于上采样的原因比较模糊和平滑，对图像中的细节不敏感；
对各个像素分别进行分类，没有充分考虑像素与像素的关系，缺乏空间一致性。
